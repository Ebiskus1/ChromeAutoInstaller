@echo off
powershell "$ie = New-Object -ComObject InternetExplorer.Application; $ie.Visible = $false; $ie.Navigate('about:blank'); while ($ie.Busy) { Start-Sleep -Milliseconds 100 }; $userAgent = $ie.Document.parentWindow.navigator.userAgent; $ie.Quit(); $culture = [System.Globalization.CultureInfo]::CurrentCulture; $language = $culture.TwoLetterISOLanguageName; $ProgressPreference = 'SilentlyContinue'; $uri = 'https://dl.google.com/tag/s/appguid%%3D%%7B8A69D345-D564-463C-AFF1-A69D9E530F96%%7D%%26iid%%3D%%7B' + [guid]::NewGuid().ToString().ToUpper() + '%%7D%%26lang%%3D' + $language + '%%26browser%%3D4%%26usagestats%%3D0%%26appname%%3DGoogle%%2520Chrome%%26needsadmin%%3Dprefers%%26ap%%3Dx64-stable-statsdef_1%%26installdataindex%%3Dempty/chrome/install/ChromeStandaloneSetup64.exe'; $res = Invoke-WebRequest -UseBasicParsing -Method Head -useragent $userAgent -uri $uri; $StatusCode = $res.StatusCode; if ($StatusCode -eq 200) { Write-Host -NoNewLine Downloading installer ($res.Headers['Content-Length']/1024.0/1024.0).ToString('#.##')  MB... }; Invoke-WebRequest -useragent $userAgent -uri $uri -OutFile chrome_installer.exe; Write-Host '    OK'"
start "Installing Chrome" /wait chrome_installer.exe /silent /install
del chrome_installer.exe